<form id=auth>
  <input name=email type=email placeholder=email><br>
  <input class=when-recognized name=password type=password data-typetoggle=#showpw placeholder=password><br>
  <label class=when-recognized><input id=showpw type=checkbox> Show Password</label><br>
  <button class=when-recognized>Continue</button>
</form>

<script>
$.fn.notify = function(name){
  // setup forms only
  this.filter('form').each(function(){
    var form = $(this);
    // switch to xhr submit
    form.on('submit', function(){
      form.serialize().split('&').forEach(function(pair){
        pair.replace(/([^=]+)=(.*)/,function(pair,name,value){
          $('[name='+name+']').closest('[data]').data(name, value);
        });
      });
      return false;
    });
  });
};

$('#auth')
  // peripherals
  .on('keyup', '[name=email]', function(){
    $(this).notify();
    var input = this;
    // debounce
    clearTimeout($(input).data('debounce'));
    $(input).data('debounce', setTimeout(function(){
      var rules = { is_email: /^[^@]+@.+\.[^.]{2,}$/ };
      for (var rule in rules) (function(matches){
        $(input).trigger('set', [rule, matches]);
      })(input.value.match(rules[rule]));
    }, 300));
  })
  // actions
  .on({ 
    'set': function(e, rule, matches){
      if (!matches) return;
      
	    if ('is_email' == rule)
	      $(e.target)
	        .closest('[data]')
	          .data('email', matches[0])
	          .trigger('change');
	  },
	  'call': function(e){
	    console.debug(e.type, arguments);
	  },
	  'authenticate': function(){
			// Stop password maskingâ Jacob Nielsen
			// http://www.useit.com/alertbox/passwords.html
			$('[name=password]').showPassword();
	  },
	  'change': function(){},
	  'init': function(e){
	    console.info(e.type, arguments);
	  } })
  .trigger('init');

</script>
<form id=member>
  <i>To see and save your policy, please tell us how to contact you:</i>
  <input name=tel type=tel placeholder="by phone"> or
  <input name=email type=email placeholder="by email"><br>
  
  <span class=when-returning>
	  <i>If you have been here before</i>
	  <input name=password type=password data-typetoggle=#showpw placeholder="enter your password"><br>
	  <label><input id=showpw type=checkbox> Show Password</label><br>
  </span>
  
  <button>Continue</button>
</form>

<script>
try { history.pushState(member, 'Welcome', '/welcome'); }
catch (e) { location.hash = 'welcome' }

// TODO implement as agnostic feature
recognize(
    // hide policy until authenticated
    $('#policy').addClass('when-authenticated')
    .selector, 'loaded');
    
$('#member')
  .snitch()
  .submit(function(e){
    // if ok, load next
    $(this).hide()
    $('#policy').show();
    recognize('policy', 'coming up');
    //console.clear();
    return false;
  })
  // peripherals
  .on('keyup', '[name=email]', function(){
    var input = this;
    // debounce
    clearTimeout($(input).data('debounce'));
    $(input).data('debounce', setTimeout(function(){
      var rules = { is_email: /^[^@]+@.+\.[^.]{2,}$/ };
      for (var rule in rules) (function(matches){
        $(input).trigger('set', [rule, matches]);
      })(input.value.match(rules[rule]));
    }, 300));
  })
  // actions
  .on('authenticate', function(){
      // Stop password maskingâ Jacob Nielsen
      // http://www.useit.com/alertbox/passwords.html
      $('[name=password]').showPassword();
  });
</script>